/*!
 * jTab is “Displays content in tabs for jQuery framework”.
 *
 * @author demorfi <demorfi@gmail.com>
 * @version 1.0
 * @source https://github.com/demorfi/jtab
 * @license http://opensource.org/licenses/MIT Licensed under MIT License
 */
(function(b){b.fn.jtab=function(c){var d=new a(this,c);d.init();return(d)};var a=function(d,c){this.version=1;this.options=b.extend(true,{start:1,params:false,trackingHash:true,callback:{init:b.noop,trigger:b.noop,change:function(e){this.closeAllTab(e.parent,true).openTabId(e.id,true);this.getCallback("trigger").call(this,e,"change")},select:function(f,e){if(!b(e.currentTarget).hasClass(this.getClass("selected"))){this.toggleTab(this.getTabId(e.currentTarget));this.getCallback("trigger").call(this,f,"select")}return(false)},content:function(e){if(b(e.self).data("loaded")===undefined){b(e.self).data("content",b(e.self).html()).empty().addClass(this.getClass("loading")).load(e.ref,this.getOption("params"),b.proxy(function(g,f,h){(h==="error"&&b(g.self).html(b(g.self).data("content")));b(g.self).removeClass(this.getClass("loading")).data("loaded",true);this.getCallback("trigger").call(this,g,"loaded")},this,e))}this.getCallback("trigger").call(this,e,"content");this.hasAnimate("open")?this.getAnimate("open").call(this,e.self):e.self.show()},hash:function(e){b('[href="'+this.getTabIdHref(e.id)+'"]').trigger("click.jtab")}},animate:{open:false,close:false},"class":{wrapper:"jtab-wrapper",selected:"jtab-selected",content:"jtab-content",loading:"jtab-loading"}},c);this.$el=b(d);return(this)};a.prototype={init:function(){var c=this;b.each(this.$el,function(){b(this).data("jtabObject",c).wrap(b("<div>").addClass(c.getClass("wrapper"))).show();var d=b(this).find("a"+c.getClass("selected",true)).length?b(this).find("a"+c.getClass("selected",true)):b(this).find("a:eq("+(c.getOption("start")-1)+")");c.closeAllTab(this,false,true);c.openTabId(c.getTabId(d.data("jtabCurrent",true)));b(this).data("jtabCount",b(this).find("a").size());b(this).find("a").on("click.jtab",b.proxy(c.getCallback("select"),c,{parent:this}));c.getCallback("init").call(c,{self:this})});this.getOption("trackingHash")&&this.triggerTracking()},triggerTracking:function(){b(window).on("hashchange",b.proxy(function(){var c=location.hash.replace(/^#!/,"#");if(this.$el.find('[href="'+this.getTabIdHref(c)+'"]').length){this.getCallback("hash").call(this,{id:c})}},this));if(location.hash.length){b(window).trigger("hashchange")}},getClass:function(d,c){return((c?".":"")+this.options["class"][d])},getCallback:function(c){return(b.isFunction(this.options.callback[c])?this.options.callback[c]:b.noop)},getOption:function(c){return(this.options[c])},setOption:function(c,d){this.options[c]=d},getVersion:function(){return(this.version)},getAnimate:function(c){return(b.isFunction(this.options.animate[c])?this.options.animate[c]:b.noop)},hasAnimate:function(c){return(b.isFunction(this.options.animate[c]))},toggleTab:function(d){var c=b(this.getClass("wrapper",true)).find('[href="'+this.getTabIdHref(d)+'"]');this.getCallback("change").call(this,{self:b(d),parent:c.closest(this.getClass("wrapper",true)).children("ul"),id:d})},openTabId:function(g,c,d){var f=b(g);if(f.hasClass(this.getClass("selected"))&&!d){return(false)}var e=b('[href="'+this.getTabIdHref(g)+'"]').addClass(this.getClass("selected")).data("jtabCurrent",true).data("content");if(!b.isEmptyObject(f)){location.hash=g.replace(/^#/,"#!");f.addClass(this.getClass("selected"));this.getCallback("trigger").call(this,f,"open");if(e===undefined||!e.length){return(c&&this.hasAnimate("open")?this.getAnimate("open").call(this,f):f.show())}this.getCallback("content").call(this,{self:f,ref:e,id:g})}return(true)},closeTabId:function(f,c,d){var e=b(f);if(!e.hasClass(this.getClass("selected"))&&!d){return(false)}b('[href="'+this.getTabIdHref(f)+'"]').removeClass(this.getClass("selected")).removeData("jtabCurrent");if(!b.isEmptyObject(e)){e.removeClass(this.getClass("selected"));this.getCallback("trigger").call(this,e,"close");if(!e.hasClass(this.getClass("content"))){e.addClass(this.getClass("content"))}return(c&&this.hasAnimate("close")?this.getAnimate("close").call(this,e):e.hide())}return(true)},closeAllTab:function(d,c,e){var f=this;b(d).find("a").each(function(){f.closeTabId(f.getTabId(this),c,e)});return(this)},getTabId:function(c){return(b(c).attr("itemid")?b(c).attr("itemid"):b(c).attr("href"))},getTabIdHref:function(d){var c=b('[itemid="'+d+'"]');return(c.length?c.attr("href"):d)}};b(function(){b(".jtab-trigger").jtab()})})(jQuery);